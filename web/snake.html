<!-- snake.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Snake Game</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main>
    <h1>Snake Game</h1>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <div>
      <input type="text" id="playerName" placeholder="Your Name (optional)" />
      <button id="submitScore">Submit Score</button>
    </div>
    <section>
      <h2>Top 10 High Scores</h2>
      <ol id="leaderboard"></ol>
    </section>
    <a href="index.html">Back to Home</a>
  </main>
  <script src="script.js"></script>
</body>
</html>

/* styles.css */
body {
  font-family: system-ui, sans-serif;
  margin: 0;
  padding: 0;
  background: #f4f4f4;
  color: #333;
}
header {
  background: #0078d4;
  color: white;
  padding: 1rem;
  text-align: center;
}
nav a {
  margin: 0 1rem;
  color: white;
  text-decoration: none;
}
main {
  padding: 2rem;
}
canvas {
  background: #222;
  display: block;
  margin: 1rem auto;
  border: 1px solid #ccc;
}
input {
  margin-top: 1rem;
  padding: 0.5rem;
  width: 200px;
}
button {
  margin-left: 1rem;
  padding: 0.5rem 1rem;
  background: #0078d4;
  color: white;
  border: none;
  cursor: pointer;
}
footer {
  text-align: center;
  padding: 1rem;
  background: #eee;
  margin-top: 2rem;
}

// script.js
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
let snake = [{ x: 10, y: 10 }];
let apple = { x: 5, y: 5 };
let dx = 0;
let dy = 0;
let score = 0;

function drawCell(x, y, color) {
  ctx.fillStyle = color;
  ctx.fillRect(x * 20, y * 20, 20, 20);
}

function gameLoop() {
  let head = { x: snake[0].x + dx, y: snake[0].y + dy };
  snake.unshift(head);

  if (head.x === apple.x && head.y === apple.y) {
    score++;
    apple = { x: Math.floor(Math.random() * 20), y: Math.floor(Math.random() * 20) };
  } else {
    snake.pop();
  }

  if (head.x < 0 || head.y < 0 || head.x >= 20 || head.y >= 20 || snake.slice(1).some(s => s.x === head.x && s.y === head.y)) {
    clearInterval(loop);
    alert("Game over! Score: " + score);
  }

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawCell(apple.x, apple.y, "red");
  snake.forEach(s => drawCell(s.x, s.y, "green"));
}

let loop = setInterval(gameLoop, 150);

document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp") [dx, dy] = [0, -1];
  if (e.key === "ArrowDown") [dx, dy] = [0, 1];
  if (e.key === "ArrowLeft") [dx, dy] = [-1, 0];
  if (e.key === "ArrowRight") [dx, dy] = [1, 0];
});

document.getElementById("submitScore").addEventListener("click", async () => {
  const name = document.getElementById("playerName").value;
  await fetch("https://YOUR-FUNCTION-APP.azurewebsites.net/api/highscore", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, score })
  });
});

// Fetch leaderboard
fetch("https://YOUR-FUNCTION-APP.azurewebsites.net/api/highscore")
  .then(res => res.json())
  .then(data => {
    const leaderboard = document.getElementById("leaderboard");
    data.slice(0, 10).forEach(entry => {
      const li = document.createElement("li");
      li.textContent = `${entry.name || "Anonymous"}: ${entry.score}`;
      leaderboard.appendChild(li);
    });
  });
